import{c as _,F as n,C as b,J as h,b as u,s as w,i as v,a as y,d as q,r as S}from"../../footer-DnGZcwvZ.js";import{i as F}from"../../breadcrumbs-CAkD3n4l.js";function P(s){return _(s,{tag:"form",render(e,d,p,{runOnce:c}){const{onSubmit:m,onBack:f}=d;if(c){e.className="registration-form",e.innerHTML=`
          <div class="registration-form__section registration-form__section_personal">
            <h2 class="registration-form__title">Personal Information</h2>
            <div class="registration-form__fields-container" data-group="personal"></div>
          </div>

          <div class="registration-form__section">
            <h2 class="registration-form__title">Sign In Information</h2>
            <div class="registration-form__fields-container" data-group="auth"></div>
          </div>

          <div class="registration-form__actions">
            <button type="submit" class="registration-form__btn-submit button button_solid button_black">
              Create an Account
            </button>
            <button type="button" class="registration-form__btn-back button">
              Back
            </button>
          </div>
        `;const r={first_name:n({label:'First name <span class="highlight-required">*</span>',inputProps:{name:"first_name",id:"reg-fn",placeholder:"Enter your first name"}}),last_name:n({label:'Last Name <span class="highlight-required">*</span>',inputProps:{name:"last_name",id:"reg-ln",placeholder:"Enter your last name"}}),newsletter:b({label:"Sign Up for Newsletter",inputProps:{name:"is_subscribed_for_newsletter",id:"reg-newsletter"}}),email:n({label:'Email <span class="highlight-required">*</span>',inputProps:{name:"email",type:"email",id:"reg-email",placeholder:"example@mail.com"}}),password:n({label:'Password <span class="highlight-required">*</span>',inputProps:{name:"password",type:"password",id:"reg-pass",placeholder:"********"}}),confirm_password:n({label:'Confirm Password <span class="highlight-required">*</span>',inputProps:{name:"confirm_password",type:"password",id:"reg-confirm",placeholder:"********"}})};e.querySelector('[data-group="personal"]').append(r.first_name,r.last_name,r.newsletter),e.querySelector('[data-group="auth"]').append(r.email,r.password,r.confirm_password);const l=new h(e,{errorLabelStyle:void 0,errorsContainer:".form-field__message-text",validateBeforeSubmitting:!0}),i=(a,t,o)=>{l.addField(t,o,{errorsContainer:a.querySelector(".form-field__message-text")})};i(r.first_name,"#reg-fn",[{rule:"required",errorMessage:"First name is required"}]),i(r.last_name,"#reg-ln",[{rule:"required",errorMessage:"Last name is required"}]),i(r.email,"#reg-email",[{rule:"required",errorMessage:"Email is required"},{rule:"email",errorMessage:"Email is invalid"}]),i(r.password,"#reg-pass",[{rule:"required",errorMessage:"Password is required"},{rule:"minLength",value:8}]),i(r.confirm_password,"#reg-confirm",[{rule:"required",errorMessage:"Please confirm your password"},{validator:(a,t)=>a===t["#reg-pass"].elem.value,errorMessage:"Passwords should match"}]),l.onValidate(({fields:a})=>{Object.values(a).forEach(t=>{const o=t.elem?.closest(".form-field"),g=t.isValid;o&&(g?o.classList.remove("form-field_message-default"):o.classList.add("form-field_message-default"))})}),l.onSuccess(()=>{const a=Object.fromEntries(new FormData(e));a.is_subscribed_for_newsletter=!!a.is_subscribed_for_newsletter,m?.(a)}),e.querySelector(".registration-form__btn-back").addEventListener("click",()=>f?.()),e._els={validator:l}}}})}async function C(){const{data:s}=await w.auth.getSession();return s.session}async function E(s=u){if(await C()){window.location.href=s;return}document.querySelector("#private-content").removeAttribute("id")}document.addEventListener("DOMContentLoaded",async()=>{await E(`${u}catalog/`),v(),F(".registration-page__breadcrumbs"),L(),y()});function L(){const s=q({successText:"Вход выполнен успешно!"}),e=P({onSubmit:async({confirm_password:p,...c})=>{try{s.show(),await S(c),s.success(),location.reload()}catch(m){s.hide(),console.error("Ошибка входа:",m)}},onBack:()=>{window.history.length>1?window.history.back():window.location.href=u}});document.querySelector(".registration-page__content").appendChild(e)}
