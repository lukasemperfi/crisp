import{i as m,a as u,l as p}from"../../../footer-hohNfXYL.js";import{i as d}from"../../../dropdown-Etj7YRTy.js";import{i as E}from"../../../breadcrumbs-Un-TCqts.js";import{i as _}from"../../../profile-section-Lnmzs4iE.js";import{J as L,F,R as c,a as R,E as O,b as P,c as y}from"../../../rules-BILaquOo.js";import{i as M}from"../../../upload-photo-BjjRfj-U.js";import{u as g}from"../../../profile-Byp8cCDH.js";import{a as C}from"../../../breadcrumbs-BENUYkyx.js";const i={FORM:"#profile-contacts-form",FULL_NAME:"#profile-contacts-full-name",EMAIL:"#profile-contacts-email",PHONE:"#profile-contacts-phone",FILE:"#profile-contacts__avatar-file"},l={[i.FULL_NAME]:[c,P],[i.EMAIL]:[c,O],[i.PHONE]:[c,R],[i.FILE]:[...F]};function S(){const e={errorFieldCssClass:"form-field__input_error",errorLabelCssClass:"form-field__error",focusInvalidField:!0,lockForm:!0,validateBeforeSubmitting:!0,errorFieldStyle:{},errorLabelStyle:{}},o=new L(i.FORM,e);for(const r in l)o.addField(r,l[r]);return o}const U=()=>{S().onSuccess(async e=>{e.preventDefault();const o=document.querySelector(i.FORM),r=new FormData(o),a=Object.fromEntries(r.entries()),s=h(a),t=y({successText:"Данные изменены успешно!"});try{await g.updateProfile(s),t.success(),setTimeout(()=>{window.location.reload()},1e3)}catch(n){console.error("Ошибка при обновлении профиля:",n),t.hide()}}),M()},f=(e,o,r)=>{const a={},s=[];for(const t in e)if(t.startsWith(o)){const n=t.replace(o,"");a[n]=e[t],s.push(t)}return s.forEach(t=>delete e[t]),e[r]=a,a},h=e=>{const o=e.person_type;return o==="fop"&&f(e,"fop_","fop"),o==="legal"&&f(e,"legal_entity_","legal_entity"),e};document.addEventListener("DOMContentLoaded",async()=>{await C(),d({selector:".top-header__lang"}),m(),E(),_(),U(),u(),p(".lazy",{rootMargin:"200px 0px"})});
